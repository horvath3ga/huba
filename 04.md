|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 1/33|

# – GVK_UC_H04  HUBA Kód és hely RÉSZLETES RENDSZERTERV
## 2024. május 22.
### V1.0


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 2/33|

#### **Dokumentum történet **

Kidolgozó változtatások követése





|Verzió|Dátum|Változtatás leírása / megjegyzések|Kidolgozta, módosította|Col5|
|---|---|---|---|---|
||||Név|Állapot|
|7.0|2024.06.13.|#89370: H04_01_HUBA_Kód_és_hely ablak - KésésFőKód választás + naplózása|Kovács Eszter|Folyamatban|
|7.0|2024.06.19.|#89371: H04_01_HUBA_Kód_és_hely ablak - 'Topográfiai elem' kiválasztása|Kovács Eszter|Folyamatban|
|7.0|2024.06.19.|#89250: H04_01_HUBA_Kód_és_hely ablak kialakítása|Kovács Eszter|Folyamatban|
|7.0|2024.06.19.|#89372: H04_01_HUBA_Kód_és_hely ablak - 'Terület' kiválasztása|Kovács Eszter|Folyamatban|
|7.0|2024.06.26|#89373:H04_01_HUBA_Kód_és_hely ablak - 'Szakasz' kiválasztása|Kovács Eszter|Folyamatban|
|7.0|2024.07.29.|#89375 - H04_01_HUBA_Kód_és_hely ablak - 'Jármű / Vonat / Egyéb' kiválasztása tab kialakítása|Kovács Eszter|Folyamatban|
|7.0|2024.07.29.|#893783 - H04_01_HUBA_Kód_és_hely ablak - HUBA betűkód|Kovács Eszter|Folyamatban|
|7.0|2024.07.29.|#89383: H04_01_HUBA_Kód_és_hely ablak - HUBA betűkód + azonosító|Kovács Eszter|Folyamatban|
|7.0|2024.08.14.|#89385 - GVK - Területi lehatárolás felhasználása|Kovács Eszter|Folyamatban|
|7.0|2024.08.27.|#93153 - H04_01 - HUBA Kód és hely ablak - Törlés és piktogram kezelés|Kovács Eszter|Folyamatban|
|7.0|2024.08.29.|#93236 - H04_01 - HUBA Kód és hely ablak - HUBA azonosító|Kovács Eszter|Folyamatban|
|7.0|2024.09.04|#93505 - H04_01 - HUBA Kód és hely ablak - ablaknavigáció|Kovács Eszter|Folyamatban|
|7.0|2024.09.12|#93801 - GVK - HUBA - Pre_activity_ID töltése|Vörös Gábor|Ellenőrizhető|
|7.0|2024. 09. 24.|#89383 – GVK HUBa betűkód kivezetése|Berkesi Ádám|Ellenőrizhető|
|7.0|2024.10.17|#92775 - DB mentés sikertelenségéről felhasználó tájékoztatása|Kovács Eszter|Ellenőrizhető|
|7.0|2024.10.28|#95441 - HUBA - H04_01 - Terület érték automatikus feltöltése értékkel|Kovács Eszter|Ellenőrizhető|
|7.1|2025.01.14|#96564 - HUBA - Konkurenskezelés trace condition megoldása|Vörös Gábor|Elkészült|
|7.2|2025.01.21|#98613 - HUBA - Global AD-ból keresés 3 karakter megadását követően - első 3 karakter|Kovács Eszter|Ellenőrizhető|
|7.0|2025.03.25.|#100650 - GVK - HUBA - H04_01 - A főkódok között csak azokat lehessen kiválasztani, aminél a <ResJelzo> tag-ben „1” érték szerepel|Kovács Eszter|Folyamatban|


MÁV SZK Ellenőrzések követése



|Verzió|Dátum|Változtatás leírása / megjegyzések|Kidolgozta, módosította|Col5|
|---|---|---|---|---|
||||Név|Állapot|
|1.0|2024.05.17|MÁV Véglegesítésre átadható|Kovács Eszter||
||||||
||||||


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 3/33|


MÁV Engedélyeztetés követése/ eredmény átvétele

|Verzió|Dátum|Változtatás leírása / megjegyzések|Név|Aláírás|
|---|---|---|---|---|
||||||
||||||
||||||
||||||


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 4/33|

#### **1. Általános ismertetés **
##### **1.1. A használati eset modulkapcsolatai **

**Szolgáltatások leírásának elérhetősége:** [#95441 ]

[GVK_webalkalmazás_szolgáltatások.docx](https://ituzletag.mav-szk.hu/projekt/gvk/_layouts/15/DocIdRedir.aspx?ID=U26HEUY2JR42-2121121297-1301)


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 5/33|

##### **1.2. A használati eset célja, feladatai **

A használati eset alapvető célja, hogy a Bejegyzés

  - Késés főkódjának megadása

  - helyének rögzítését támogatja.


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 6/33|

#### **2. A használati eset ablakai **




-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 7/33|

##### 2.2. UC_H04_01 -HUBA – Kód és hely [#89250]

**2.2.1.** **Ablak/lap feladatai**

A „ **H04_01** **- HUBA – Kód és hely** ” ablak vagy a

   - „ **H01_01 - HUBA - Bejegyzések** ” ablakon lévő <Új> nyomógombra kattintással

vagy

   - „ **H02_01**    - **HUBA - Bejegyzés kezelése** ” ablakról nyitható meg, a „ *Kód és hely*

*szerkesztése* ” vagy *„Kód és hely megtekintése* ” nyomógomb kezelését

követően nyílik meg, azon GVK profil azonosítójű felhasználó számára akihez az

     - **OP_H04_01_KodEsHelySzerkeszt**

     - **OP_H04_01_KodEsHelyMegtekint** operandus hozzzá van rendelve.

**2.2.2.** **Ablak megjelenése**

A „ **H04_01** **- HUBA – Kód és hely** ” ablak új böngésző lapon nyílik meg, és három féle
módban nyitható meg:

    - Új felvitele, szerkesztés – operandus : **OP_H04_01_KodEsHelySzerkeszt**


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 8/33|



   - Megtekintés – operandus: **OP_H04_01_KodEsHelyMegtekint**


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 9/33|


**2.2.3.** **Ablak működése** [#89250]

A „ **H04_01** **- HUBA – Kód és hely** ” ablak a

vagy

       - „ **H02_01**       - **HUBA - Bejegyzés kezelése** ” ablakról nyitható meg, a „ *Kód és hely*

*szerkesztése* ” vagy *„Kód és hely megtekintése* ” nyomógomb kezelését

követően történik új böngésző lapon. ~~A~~ ~~rendszer~~ ~~az~~ „ ~~**H04**~~ **_** ~~**01**~~ ~~**-**~~ ~~**HUBA**~~ ~~**–**~~ ~~**Kód**~~ ~~**és**~~ ~~**hely**~~ ~~”~~
~~ablakot~~ ~~egy~~ ~~bejegyzés~~ ~~vonatkozásában~~ ~~maximum~~ ~~egyszer~~ ~~nyitja~~ ~~meg~~ ~~új~~ ~~böngésző~~
~~lapon~~ . Amennyiben a „ **H04_01** **- HUBA – Kód és hely** ” ablakot többször szeretné
megnyitni szerkesztésre, a konkurens kezelés miatt felugró ablak fogja a Felhasználót
fogadni.

Amennyiben az „ **H02_01**    - **HUBA - Bejegyzés kezelése** ” ablakról többször próbálja meg
a GVK profil azonosítójú felhasználó megnyitni, a korábban megnyitott „ **H04_01** **-**
**HUBA – Kód és hely”** ablak frissül az alapértelmezett módon.

**Az ablak felépítése**

     - Az ablak kitölti a teljes képernyőt.

     - Fejléc

Fejlesztői (DEV), Belső teszt (TEST) és Felhasználói teszt (QA) környezet
használatakor a fejléc háttérszíne középszürke (7F7F7F).

#82283 Üzemi (PROD)



-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 10/33|


#82283 Felhasználói teszt (QA)

Képernyőfotó a megvalósítás után.

#82283 Belső teszt (TEST)

#82283 Fejlesztői (DEV)

Képernyőfotó a megvalósítás után.

`o` Középen az ablak azonosítóját és megnevezését: „ **H04_01** **- HUBA – Kód és**

**hely** ”

`o` #58495 Jobb szélen:

         - Rendszer neve és logója, valamint [#70030] a rendszer neve alatt a

frontend verziószáma jelenik meg.

         - A logó előtt a GVK környezet neve:

             - üzemi (PROD): Nem jelenik meg a kliensen.

             - #66395 felhasználói teszt (QA): „ **QA** ”

             - teszt (TEST): „ **TEST** ”

             - fejlesztői (DEV): „ **DEV** ”

         - ~~#82283~~ GVK profil név:
A GVK-ba történt bejelentkezéskor érvényes GVK profil név
megjelenítésére szolgál. [#82283 vége ]

      - #89383 Fejléc alatt az alábbi két adat jelenik meg:

`o` #93236 HUBA Azonosító ( BEJEGYZES.HUBA_AZONOSITO)

      - A tartalmi rész három nagyobb részből áll:

`o` Felső sor (Késés főkód és [#89838] ~~HUBA~~ ~~Betűkód~~ [#89838] )
`o` a bal oldalon található TAB-onként elkülönítve, a kiválasztható

helyszínek.

`o` Jobb oldalon egy táblázat (listbox) található, amelyben a

kiválasztott, hozzáadott helyszín(ek) felsorolva jelen(nek) meg

**Az ablak működési leírása** [[#89250]](https://tadads1.tad.mavinformatika.hu/MAVICollection/IFP/_workitems/edit/89370)

A képernyő három különböző módban nyitható meg:

    - Új felvitel

„ **H01_01 - HUBA - Bejegyzések** ” ablakon lévő <Új> nyomógombra kattintásal
lehetséges. Ebben az esetben a „ **H04_01** **- HUBA – Kód és hely** ” képernyő


**Formatted:** Strikethrough

**Formatted:** Strikethrough


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 11/33|


mentésével jön létre a Bejegyzés és a hozzá tartozó helyszín. Ebben az esetben
nincs konkurenskezelés. A HUBA azonosító a <Mentés> nyomógombra
kattintáskor generálódik le.

     - Szerkesztés

„ **H02_01**        - **HUBA - Bejegyzés kezelése** ” ablakról indíthatja a „ *Kód és hely*
*szerkesztése* ” nyomógombról. A meglévő Bejegyzés helyszínének szerkesztése
esetén betöltéskor feltöltődnek a mezők a korábban mentett tartalommal,

illetve a konkurenskezelés is aktív.

     - Megtekintés

„ **H02_01**        - **HUBA - Bejegyzés kezelése** ” ablakról indíthatja a „ *Kód és hely*
*megtekintése* ” nyomógombról. Megtekintés esetén betöltéskor feltöltődnek a
mezők a korábban mentett tartalommal, minden mező inaktív, és nincs

konkurenskezelés sem.

**Ablak betöltés** **[#96564 ]**

Amennyiben a felhasználó módosításra nyitotta meg a képernyőt, az alábbi sorrendben
hajtódik végre az ablak betöltése. A kliens meghívja az „ **S_27 – Felhasználói aktivitás**
**naplózása** ” szolgáltatást az alábbi bemenő paraméterekkel:

  - Ablakazonosító (’WINDOW_ID’): „H04_01”

  - Esemény (’ACTIVITY’): „WindowOpen”

  - AD felhasználó (’AD_USER’): bejelentkezett felhasználó AD azonosítója

  - GVK felhasználó (’GVK_USER’): GVK felhasználói profil azonosítója

  - Esemény kiegészítő információk (’ACTIVITY_EXT’): „Modify”

  - Bejegyzés azonosító (’MAIN_ID’): HUBA bejegyzés azonosítója

  - Bejegyzés sub azonosító (’SUB_ID’): NULL

  - Előzmény felhasználói aktivitás azonosító (’PRE_ACTIVITY_ID’): NULL

A kliens az „ **S_27 – Felhasználói aktivitás naplózása** ” szolgáltatástól kétféle módon kaphat

vissza értéket:

Amennyiben az **„EDITABILITY”** mezőben ’0’ (azaz nulla) érték érkezik, és **„ACTIVITY_ID”** érték
is érkezik a válaszban, a kliens folytatja konkurenskezelés indításával a folyamatot, és a

felahasználó szerkesztheti a kívánt adatelemet.

Amennyiben az **„EDITABILITY”** mezőben ’0’ (azaz nulla) érték érkezik, és az **„ACTIVITY_ID”**
mező nem tartalmaz értelmezhető adatot (azaz az értéke NULL), abban az esetben valamilyen
adatbázis oldali hiba történt, és az alábbi hibaüzenet kerül megjelenítésre, majd az OK-ra
kattintva a képernyő bezárul:


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 12/33|


Amennyiben az eljárástól válaszként az **„EDITABILITY”** mezőben egy ’0’-tól (azaz nullától)
eltérő numerikus érték érkezik, abban az esetben egy másik felhasználó már szerkeszti a kívánt
adatelemet, ezért a kliens hibaüzenetet küld az alábbiak szerint:

Ezután a felhasználó dönt, hogy bezárja az üzenet ablakot (amivel a teljes képernyő is bezárul),
vagy megnyitja a kívánt képernyőt megtekintési nézetben, és a képernyő betöltésének
végrehajtása ott folytatódik.

Amennyiben a felhasználó módosításra nyitotta meg a képernyőt, és a felhasználói aktivitás
logolásnál kapitt vissza érvényes **„ACTIVITY_ID”** -t, azzal elindítja a Konkurenskezelés
életjelküldés funkcióját, a **„K_15_02 – Életjel küldés (SET_DATA_LIFESIGN)”** függvény 20mpént (rendszerparaméterben meghatározott) történő meghívásával.
Az életjel küldés funkció minden esetben ellenőrizni fogja a munkamenet érvényességét, és

eszerint választ küld a kliensnek az alábbiak szerint:

  - „OK” – a függvény frissítette a munkamenetet, a szerkesztés folytatható

  - „CEASED_ACTIVITY” – valamilyen esemény folytán a munkamenet megszakadt, de a

munkamenet még nem került a háttérben lezárásra. Ilyenkor a felhasználó dönthet,
hogy folytatja-e a munkát. Ez az eset akkor fordulhat elő, ha az életjel küldés legutóbb
1 percnél korábban futott le, de még nem érte el a 10 percet (rendszerparaméterben
meghatározott időzítések).

A kliens az alábbi üzenetet jeleníti meg:

`o` amennyiben a felhasználó ilyenkor azt választja, hogy folytatja a munkamenetet

(Igen-re kattint), ezt megteheti, és a rendszer úgy kezeli, mintha a munkamenet


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 13/33|


folyamatos lett volna. Ebben az esetben a kliens meghívja a **„K_15_03 – Életjel**
**küldés ellenőrzés nélkül (SET_DATA_FORCE_LIFESIGN)”** eljárást az „ **S_27 –**
**Felhasználói aktivitás naplózása** ” szolgáltatástól WindowOpen eseménykor
visszakapot „ **ACTIVITY_ID** ”-val, amely ellenőrzés nélkül végrehajtja az életjel
küldés funkciót, így a továbbiakban folytatható a munkamenet a normál
kerékvágásban.

`o` a felhasználó dönthet úgy is, hogy a munkamenetet lezárja (Nem-re kattint),

ami egy <Mégsem> gomb megnyomásával egyenértékű, azaz a kliens mentés
nélkül bezárja a képernyőt. Ebben az esetben a <Mégsem> gomb megnyomása
esetén leírt folyamatok hajtódnak végre.

  - „CLOSED_ACTIVITY” – valamilyen esemény folytán a munkamenet megszakadt, és a

munkamenet a háttérben már lezárásra került, a szerkesztés NEM folytatható. Ebben
az esetben a kliensnek mentés nélkül be kell zárnia a képernyőt. Ilyen akkor fordulhat
elő, ha hosszabb kihagyás (rendszerparaméterben meghatározandó –
alapértelmezetten 10 perc) után küldött a kliens újra életjelet.

A kliens az alábbi üzenetet jeleníti meg:

Az <OK> gombra kattintás után a <Mégsem> gomb megnyomása esetén leírt
folyamatok hajtódnak végre.

  - „ERROR:MISSING_ACTIVITY” – valamilyen hiba folytán a munkamenet nem található,

akkor az eljárás ezt az üzenetet küldi vissza, majd bezárja a képernyőt.

Az <OK> gombra kattintás után a <Mégsem> gomb megnyomása esetén leírt
folyamatok hajtódnak végre.

Amennyiben a felhasználó megtekintésre nyitotta meg a képernyőt, a kliens meghívja az „ **S_27**
**– Felhasználói aktivitás naplózása** ” szolgáltatást az alábbi bemenő paraméterekkel:

  - Ablakazonosító (’WINDOW_ID’): „H04_01”

  - Esemény (’ACTIVITY’): „WindowOpen”

  - AD felhasználó (’AD_USER’): bejelentkezett felhasználó AD azonosítója

  - GVK felhasználó (’GVK_USER’): GVK felhasználói profil azonosítója


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 14/33|



  - Esemény kiegészítő információk (’ACTIVITY_EXT’): „View”

  - Bejegyzés azonosító (’MAIN_ID’): HUBA bejegyzés azonosítója

  - Bejegyzés sub azonosító (’SUB_ID’): NULL

  - Előzmény felhasználói aktivitás azonosító (’PRE_ACTIVITY_ID’): NULL

Amennyiben a felhasználó rögzítésre nyitotta meg a képernyőt, a kliens meghívja az „ **S_27 –**
**Felhasználói aktivitás naplózása** ” szolgáltatást az alábbi bemenő paraméterekkel:

  - Ablakazonosító (’WINDOW_ID’): „H04_01”

  - Esemény (’ACTIVITY’): „WindowOpen”

  - AD felhasználó (’AD_USER’): bejelentkezett felhasználó AD azonosítója

  - GVK felhasználó (’GVK_USER’): GVK felhasználói profil azonosítója

  - Esemény kiegészítő információk (’ACTIVITY_EXT’): „Create”

  - Bejegyzés azonosító (’MAIN_ID’): HUBA bejegyzés azonosítója

  - Bejegyzés sub azonosító (’SUB_ID’): NULL

  - Előzmény felhasználói aktivitás azonosító (’PRE_ACTIVITY_ID’): NULL

[#89370](https://tadads1.tad.mavinformatika.hu/MAVICollection/IFP/_workitems/edit/89370) Ezután a kliens minden kereső paraméterre vonatkozóan meghívja az „ **S_08 -**
**Lekérdezési paraméterek értékkészletének lekérdezése** ” szolgáltatást, bemenő
paraméterként átadva neki az adatelem azonosítóját (AutosuggestId).

Az S_08 hívások és az átadott értékek:

     - #89370 Késés főkód (’kesesFokod’)

     - #89371 Forgalmi szakasz (’ForgalmiSzakasz_H04_01’)

     - #89371 Szolgálati hely (’SzolgalatiHely_ H04_01’)

     - #89371 Hálózati elem tipusa (’HalozatiElemTipusa_ H04_01’)

     - #89371 Topográfiai elem (’TopografiaiElem_ H04_01’)

     - #89372 Terület (’terulet_H04_01’)

     - #89372 Forgalmi csomópont (’ForgalmiCsomopont_H04_01’)

     - #89372 Állomás főnökség (’Allomasfonokseg_H04_01’)

     - #89373 Hüsz vonal (’HuszVonal_ H04_01’)

     - #89373 Szolgálati hely tól-ig-1 (’SzakaszSzolgalatiHelyTolIg1’)

     - #89373 Szakasz tól-ig-1 (’SzakaszTolIg1’)

     - #89375 Munkatárs (’Munkatars_H04_01’)

     - #89375 Főkategória (’Fokategoria_H04_01’)

     - #89375 Alkategória (’Alkategoria_H04_01’)

      - [#89372](https://tadads1.tad.mavinformatika.hu/MAVICollection/IFP/_workitems/edit/89370) Hálózat (’Halozat_H04_01’)

     

-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 15/33|


A kliens az „ **S_08 - Lekérdezési paraméterek értékkészletének lekérdezése** ”
szolgáltatás hívások során visszakapott listaszerű adatokkal feltölti az autocomplete
(kiválasztási) funkcióval rendelkező szöveges beviteli mezők értékkészletét. A listákban
az S_08 szolgáltatás által visszaadott ’text’ paraméter értékei jelennek meg.

Szerkesztés és megtekintés esetén a kliens ezután meghívja az **„S_53 – Kód és hely**
**adatainak lekérdezése (getHubaKodEsHely)** ” eljárást a HUBA bejegyzés egyedi
azonosítóját átadva bemenő paraméterként, amely JSON-ban adja vissza a
megjelenítendő adatokat. [#95441 ] Illetve a „ **S_74** **– Bejelentkezett GVK user terület**
**adatának lekérdése (HUBA.Get_Gvk_User_Terulet)** ” eljárás is meghívásra kerül ezt
követően. [ #95441 vége]

Kiválasztott elem törlése:

Rákattintva törölhető a mellette található kiválaszott értékkészletből a kiválasztott

érték.

Amennyiben a felső értékkészletben a kiválasztott érték törlődik, úgy a hiearchiában
alatta lévő beviteli mezőkben kiválasztott érték törlődjön. (Egyéb TAB esetén a Leírás
mezőben szereplő érték is törlődjön.)

**Az ablak működési leírása** [[#89250]](https://tadads1.tad.mavinformatika.hu/MAVICollection/IFP/_workitems/edit/89370)

Az **OP_H04_01_KodEsHelySzerkeszt** operandus megléte esetén a felhasználó új

felvitelre és szerkesztésre is megnyithatja a „ **H04_01** **- HUBA – Kód és hely** ”

képernyőt. Ezt már a „ **H01_01**    - **HUBA – Bejegyzések** **”** és **„** **H02_01**    - **HUBA -**

**Bejegyzés kezelése”** ablakon ellenőrzi a rendszer, és csak akkor nyomható meg az

<új> és <Kód és hely szerkesztés> ikon, ha a fenti operandus engedélyezett a

felhasználónak.

Az **OP_H04_01_KodEsHelyMegtekint** operandus esetén csak megtekintésre
nyithatja meg a képernyőt. Ezt szintén már a **„** **H02_01**     - **HUBA - Bejegyzés kezelése”**
ablakon ellenőrzi a rendszer, és csak akkor nyomható meg a megtekintés ikon, ha
a fenti operandus engedélyezett a felhasználónak.

Megtekintés módban a felhasználó semmilyen mezőt nem szerkeszthet.

**2.2.3.1.** **Fejléc** [[#89250, #89383]](https://tadads1.tad.mavinformatika.hu/MAVICollection/IFP/_workitems/edit/89370)

A fejléc alatt az alábbi két adat jelenik meg:

   - HUBA Azonosító [, ] ~~[#89383]~~ [ #93236 ]


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 16/33|


`o` Felépítése: BEJEGYZES. HUBA_AZON OSITO ~~BEJEGYZES~~ . ~~LETREHOZAS~~ _ ~~IDO~~ ~~**-**~~

~~BEJEGYZES~~ . ~~NAPI~~ _ ~~SORSZAM~~ (Pl: 20240718-0001)

         - A LETREHOZAS_IDO mezőből csak az ÉÉÉÉ.HH.NN értéke kell

(Óra:perc:mp nem kell)

         - A NAPI_SORSZAM 4 karakter hosszú, és naponta újrakezdődik (pl:

20240730-0001)

`o` ~~Rendszer~~ ~~által~~ ~~képzett~~ ~~azonosító~~, ~~a~~ ~~Felhasználó~~ ~~által~~ ~~megadott~~ ~~adatokból~~ .

~~Felépítése:~~

~~▪~~ ~~BEJEGYZES~~ . ~~LETREHOZAS~~ _ ~~IDO~~ ~~(dátum-~~ ~~időpont)~~ ~~-~~

~~▪~~ ~~BEJEGYZES~~ . ~~KESES~~ _ ~~FOKOD~~

~~▪~~ ~~**–**~~

~~▪~~ ~~Felvehető~~ ~~értékek:~~

~~▪~~ ~~**:**~~ ~~(csak~~ ~~ha~~ ~~van~~ ~~megadva~~ ~~HUBA~~ ~~szabad~~ ~~szöveges~~ ~~rész)~~

~~▪~~ ~~HUBA~~ ~~szabad~~ ~~szöveges~~ ~~rész~~

~~Példa:~~ ~~20240731-1417-99-XXXX~~ ~~:~~ ~~alm~~ ~~a~~ [#89838]

**2.2.3.2.** **Felső sor** [#89250]

A TAB-ok felett az alábbi mezők érhetőek el, jeleníthetőek meg:

   - [#89370](https://tadads1.tad.mavinformatika.hu/MAVICollection/IFP/_workitems/edit/89370) **Késés főkód: OP_H04_01_KodEsHelySzerkeszt operandus megléte esetén a**
mező kitöltése kötelező, az ablak betöltésekor piros kerettel és felirattal jelenik
meg (megtekintés esetén a már kiválaszott adat jelenik meg), és a GVK profil
azonosítójú felhasználónak ki kell választania egyet, amely hatására a mező
felirata és kerete zöldre változik. **OP_H04_01_KodEsHelyMegtekint** operandussal
a mező inaktív. Módosítható adat. [#100650 eleje ] Csak azon Késés főkódok közül lehet
választani, aminek a K_RES_JELZO=’1’. [#100650 vége]

~~(maximum~~ ~~10karakter~~ ~~hosszút~~ ~~lehessen~~ c ~~sa~~ k ~~megadni)~~

**2.2.3.3.** ~~**Hálózati**~~ **Topográfiai elem – H04_01A** **[[#89371]](https://tadads1.tad.mavinformatika.hu/MAVICollection/IFP/_workitems/edit/89370)**


**Formatted:** Strikethrough

**Formatted:** Strikethrough


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 17/33|


**’Topográfiai elem kiválasztása forgalmi szakaszról** ’ vagy ’ **’Topográfiai elem kiválasztása**
**szolgálati helyről’** paraméterek egyike tölthető csak ki.

    - **Topográfiai elem kiválasztása forgalmi szakaszról** : Opcionális. Amennyiben a

„Topográfiai elem kiválasztása szolgálati helyről” mezőben érték van kiválasztva
,akkor ezen mező inaktívvá válik.

**VAGY**

    - **Topográfiai elem kiválasztása szolgálati helyről** : Opcionális. Amennyiben a

„Topográfiai elem kiválasztása forgalmi szakaszról” mezőben érték van
kiválasztva, akkor ezen mező inaktívvá válik.

    - **Topográfiai elem típusa** : Opcionális. Értékkészletből lehet kiválasztani. A

felvehető értékek listája attól függ, hogy milyen „Topográfiai elem” választható

ki.

    - **Topográfiai elem** : Opcionális. Kiválasztható értékkészlete függ, hogy mi a

kiválasztott érték a „Topográfiai elem kiválasztása forgalmi szakaszról” vagy a
**„** Topográfiai elem kiválasztása szolgálati helyről” mezőkben, ~~vagy~~ ~~sincs~~ . Illetve,
hogy milyen adatot jelenítünk meg, az függ a kiválasztható topográfiai elem
OBJEKTUM_TIPUS értékétől, hogy adott elem milyen tulajdonságát jelenítünk
meg/ keresünk benne. (3 karakter megadását követően keresünk),

< **Hozzáadás** - nyomógombra kattintáskor az alábbi esetek lehetségesek ezen a TAB-on:

  - Forgalmi szakasz kiválasztása

  - Szolgálati hely kiválasztása

  - Topográfiai elem kiválasztása




-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 18/33|


**2.2.3.4.** **Terület – H04_01B** **[[#89372]](https://tadads1.tad.mavinformatika.hu/MAVICollection/IFP/_workitems/edit/89370)**

 - **Hálózat** : Alapértelmezetten a „Máv Zrt.”érték van kiválasztva. Lehet az a felhasználó

döntése, hogy a kiválasztott hálózatot adja Hozzáadás nyomógombbal a kiválasztott

helyszínhez, ilyen esetben Területet nem választ ki.

 - **Terület** : a mező kitöltése nem kötelező. A mező aktív, A MÁV Zrt-hez tartozó összes

érvényes területből tud a felhasználó választani, de lehet az a döntése, hogy a
kiválaszott Területet adja Hozzáadás nyomógombbal a kiválasztott helyszínhez. [#95441]

A Terulet mezőbe alapértelmezetten a rögzítést végző GVK-s felhasználó Terület

értéke van kiválasztva, amelyet módosíthat a Felhasználó.

 - **Forgalmi csomópont:** a mező kitöltése nem kötelező. A mező inaktív marad addig,

amit ’Terület’ kiválasztása nem történik meg. A kiválasztható értékkészlet függ, hogy

milyen ’Terület’ lett kiválasztva. (csak adott Területhez tartozó érvényes Forgalmi

csomópont közül lehet választani.) Lehet az a felhasználó döntése, hogy a kiválasztott

Forgalmi csomópontot adja Hozzáadás nyomógombbal a kiválasztott helyszínhez.

 - **Állomásfőnökség:** a mező kitöltése nem kötelező. A mező inaktív marad addig, amit

’Forgalmi csomópont’ kiválasztása nem történik meg. A kiválasztható értékkészlet
függ, hogy milyen ’Forgalmi csomópont’ lett kiválasztva. (csak adott Forgalmi
csomóponthoz tartozó érvényes Állomásfőnökségek közül lehet választani.


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 19/33|


< **Hozzáadás** - nyomógombra kattintáskor az alábbi esetek lehetségesek ezen a TAB-on:

  - Hálózat

  - Terület

  - Forgalmi csomópont

  - Állomásfőnökség

**2.2.3.1.** **Szakasz H04_01C** [[#89373]](https://tadads1.tad.mavinformatika.hu/MAVICollection/IFP/_workitems/edit/89370)

  - **HÜSZ vonal:** a mező kitöltése nem kötelező. Felvehető értékek hüsz vonalszámok.

Lehet az a felhasználó döntése, hogy a kiválasztott hüsz vonalat adja Hozzáadás

nyomógombbal a kiválasztott helyszínhez, ilyen esetben nem választ ki mást a
felületen, csak HÜSZ vonalat.

**Szolgálati hellyel:**

  - **Szolgálati hely (tól-ig)1:** a mező kitöltése nem kötelező. A mező inaktív marad addig,

amit ’hüsz vonal’ kiválasztása nem történik meg. A kiválasztható értékkészlet függ,
hogy milyen ’hüsz vonal’ lett kiválasztva. (adott hüsz vonalon lévő érvényes és
sorszámozott forgalmi szakasz szolgálati hely -tól és -ig értékekből lehet választani.)

  - **Szolgálati hely (tól-ig)2:** a mező kitöltése nem kötelező. A mező inaktív marad addig,

amit ’szolgálati hely (tól-ig)1’ kiválasztása nem történik meg. A kiválasztható
értékkészlet függ, hogy milyen ’hüsz vonal’ és milyen lett Szolgálati hely (tól-ig)1 lett
kiválasztva. (adott hüsz vonalon lévő érvényes és sorszámozott forgalmi szakasz
szolgálati hely -tól és -ig értékekből lehet választani, sorrendben felsorolva)


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 20/33|


**Szelvénnyel:**

  - **Szelvény (tól-ig)1:** a mező kitöltése nem kötelező. A mező inaktív marad addig, amig

’szolgálati hely (tól-ig)1’ és ’szolgálati hely (tól-ig)2’ mezők kiválasztása nem történik
meg. A kiválasztható értékkészlet függ, hogy milyen ’szolgálati hely (tól-ig)1’ és
’szolgálati hely (tól-ig)2’ lett kiválasztva.

  - **Szelvény (tól-ig)2:** a mező kitöltése nem kötelező. A mező inaktív marad addig, amig

’szolgálati hely (tól-ig)1’ és ’szolgálati hely (tól-ig)2’ és Szelvény (tól-ig)1 mezők
kiválasztása nem történik meg. A kiválasztható értékkészlet függ, hogy milyen
’szolgálati hely (tól-ig)1’ és ’szolgálati hely (tól-ig)2’ lett kiválasztva.

< **Hozzáadás** - nyomógombra kattintáskor az alábbi esetek lehetségesek ezen a TAB-on:

   - Ha csak a HÜSZ vonal kerül kiválasztásra, ilyenkor HÜSZ vonal kerül megadásra,

hozzáadásra.

   - Ha a ’Szolgálati hely (tól-ig)1’ = ’Szolgálati hely (tól-ig)2’

          - Ilyenkor egy Szolgálati hely kerül kiválasztásra

(Azonosító=’Szolgálati hely (tól-ig)1’=’Szolgálati hely (tól-ig)2’)

(RAILWAY_OBJECT_ID)

`o` Ha a kiválaszott ’Szolgálati hely (tól-ig)1’ érték nem egyezik meg ’Szolgálati

hely (tól-ig)2’ értékkel

          - A kiválasztott ’Szolgálati hely (tól-ig)1’ és ’Szolgálati hely (tól-ig)2’

és ’HÜSZ vonal’ értékek alapján 1 vagy több Forgalmi szakasz

azonosítóható be, akkor ilyen esetben adott Forgalmi szakasz kerül

hozzáadásra kiválasztott helyszínhez. (BEJEGYZES_HELYSZIN.

SZOLGHELY_TOL és BEJEGYZES_HELYSZIN. SZOLGHELY_IG)

   - Ha a Szelvény (tól-ig)1 és Szelvény (tól-ig)2 mezőben kerül érték kiválasztva,

akkor Szelvény lett kiválasztva. (BEJEGYZES_HELYSZIN.SZELVENY_TOL és

BEJEGYZES_HELYSZIN.SZELVENY_IG)

**2.2.3.2.** **Jármű/Vonat/Egyéb** [[#89375]](https://tadads1.tad.mavinformatika.hu/MAVICollection/IFP/_workitems/edit/89370)


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 21/33|


**Vonat**

  - **Vonatazonosító:** mező kitöltése nem kötelező. Szabad szöveges mező.

  - **Közlekedési dátum:** mező kitöltése nem kötelező, de ha a ’Vonatazonosító’ érték meg

an adva, akkor kötelező tölteni. Dátum formátumban megadható érték.

**Jármű**

  - **Pályaszám / egyéb azonosító :** mező kitöltése nem kötelező. Abban az esetben lehet

meadni, ha a Vonat részen nincs megadva adat. Formai ellenőrzés szükséges ezen
beviteli mezőre. Amennyiben a formai ellenőrzésen nem megfelelő adat kerül
berögzítésre, úgy kérik a „Nem szabványos” feliratot kiírni. (példa: 378478381304,
314621871206)

  - Ellenőrzés:

`o` 12 jegyű kell legyen és csak számokat tartalmazhat
`o` Ezen kívül az ellenőrzőszámnak (a 12. jegye) megfelelőnek kell lennie

(modulo10)

       - Balról az első 11 szám páratlan helyértékű számjegyeit 2-vel meg kell

szorozni, a páros helyértékűeket saját értékükön kell figyelembe venni:

3 7  8 4  7 8 3 8 1 3 0 -> 6  7  16  4  14  8  6  8  2  3  0

       - A szorzatok szájegyeit össze kell adni:

6 7 16 4  14  8  6  8  2  3  0 -> 6 7  7 4  5 8 6 8  2 3 0

       - Majd ezeket is össze kell adni:

6+7+7+4+5+8+6+8+2+3+0=56


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 22/33|



       - A végösszeg (56) egyes helyértékén adódó számot 10-ből ki kell vonni, a

maradék a helyes ellenőrző szám:

10-6=4

~~•~~ ~~Ha~~ ~~a~~ ~~12~~ . ~~szám~~ ~~nem~~ ~~egyenlő~~ ~~a~~ ~~hely~~ es ~~ellenőrző~~ ~~számmal~~ ~~(4)~~ ~~akkor~~ ~~a~~ ~~mező~~

~~hibás~~, ~~alatta~~ ~~a~~ „ ~~Az~~ ~~ellenőrzőszám~~ ~~hi~~ b ~~ás~~ . ~~”~~ ~~üzenet~~ ~~jelenik~~ ~~meg~~ .
```
     o

```
**Egyéb**

Főkategória nincs kiválasztva. Kiválasztható értékei függnek a kiválasztott
Főkategóriától.

  - **Munkatárs:** a mező kitöltése nem kötelező. Global AD user neve vagy szabad

szövegesen beírt név rögzíthető. . Kereséskor töredék információkra is elindítható a
keresés, ~~tartalmazó~~ ~~kereséssel~~ [#] [98613 ] név eleji egyezéssel [#98613], de minimum 3 karaktert
meg kell adnia a GVK profil azonosítójú felhasználónak.

Amennyiben a felső értékkészletben a kiválasztott érték törlődik, úgy a hiearchiában alatta
lévő beviteli mezőkben kiválasztott érték törlődjön. (Egyéb TAB esetén a Leírás mezőben
szereplő érték is törlődjön.)

< **Hozzáadás** - nyomógombra kattintáskor az alábbi esetek lehetségesek:

   - Vonat: Vonatazonosító / Közlekedési dátum (pl:1033/2024.08.06)

   - Jármű: Pályaszám/ egyéb azonosító (pl: 189745698213548)

– kistermetű)

**2.2.3.3.** **Kiválasztott helyszín** [[#89250]](https://tadads1.tad.mavinformatika.hu/MAVICollection/IFP/_workitems/edit/89370)

A „ **H04_01** **- HUBA – Kód és hely** ” ablak Helyszín kiválasztásának szekció két fő részből

épül fel:

    - a bal oldalon található TAB-onként elkülönítve, a kiválasztható helyszínek.

    - Jobb oldalon egy táblázat (listbox) található, amelyben a kiválasztott, hozzáadott

helyszín(ek) felsorolva jelen(nek) meg.






-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 23/33|


Amikor a GVK profil azonosítójú felhasználó kiválaszt egy helyszínt és a

táblázatba.

Visszafelé úgyműködik, hogy a „Kiválasztott helyszínből” törlendő elemet kijelöljük, és a
Törlésre kattint. Ekkor a kiválasztott helyszín eltűnik a listából.
A táblázat a kiválasztott helyszíneket mutatja.

#93153 A táblázatban az alábbi típusokhoz megjelenítendő ábrák láthatóak:













|Szimbólum|HELYSZIN_TIPUS NEV|HELYSZIN_ TIPUS_ID|IKON_NEV|
|---|---|---|---|
||Szolgálati helyek|1|szolghely.png|
||Peronok|2|peron.png|
||Alállomások|3|alallomas.png|
||Gázolaj feladó és lefejtőkutak|4|gazolajkut.png|
||Kitérők|5|kitero.png|
||Alagutak|6|alagut.png|
||Szelvények|7|szelveny.png|
||Hidak|8|hid.png|
||Jármű ellenőrző berendezések|9|jarmuellenorzo.png|
||Fény bejárati-, kijárati- és fedezőjelzők|10|fenyjelzo.png|
||Térközjelzők|11|terkozjelzo.png|
||Alakjelzők|12|alakjelzo.png|
||Elő-, ismétlő- és mellékvonali ellenőrző jelzők|13|ismetlojelzo.png|


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 24/33|







|Col1|Tolatásjelzők|14|tolatasjelzo.png|
|---|---|---|---|
||Megállj! Jelzők|15|megalljjelzo.png|
||Tolatási határjelzők|16|thjelzo.png|
||Fázishatárok|17|fazishatar.png|
||Vágányzáró sorompók, siklasztósaruk|18|vaganyzaro.png|
||Biztonsági határjelzők|19|bizthatarjelzo.png|
||Sorompók|20|sorompo.png|
||Útátjárók|21|utatjaro.png|
||Forgalmi szakasz|22|forgszakasz.png|
||HÜSZ vonal|23|husz.png|
||Vonat/Közlekedési dátum|24|vonat.png|
||Jármű (Nem vonatban lévő)|25|jarmu.png|
||Hálózat|26|halozat.png|
||Terület|27|terulet.png|
||Forgalmi csomópont|28|forgcsompont.png|
||Állomásfőnökség|29|allomasfonokseg.png|


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 25/33|


**Nyomógombok működése** [[#89250]](https://tadads1.tad.mavinformatika.hu/MAVICollection/IFP/_workitems/edit/89370)

**Hozzáadás**

szerkesztés módban érhető el/ nyomható meg) a „ **H04_01** **- HUBA – Kód és hely** ”
ablakon az alábbi folyamatok futnak le a lenti sorrendben:

     - #89385 Jogosultság kiértékelés: Amennyiben olyan kiválaszott helyszín van
(forgalmi szakasz vagy szolgálati hely) amelynek van hierarchia szintje és a
rögzítést végző GVK-s felhasználóhoz beállított hierarchia eltér, úgy egy felugró
pop-up ablakban hívja fel a rögzítő figyelmét, hogy: „ **S_61** – Hierarchia adatok
lekérése (HUBA.Get_Hierarchia_adat)”

     
`o` < **Ok**       - nyomógomb: Lefutásra kerül
`o` < **Mégsem**       - a felugró ablak bezáródik, és a kiválaszott helyszínhez nem

adódik hozzá az elem.

     
#93153 **Törlés**

rendszer törölt státuszúra állítja az adott HELYSZIN_ID-t.
(BEJEGYZES_HELYSZIN.TOROLT=I), a továbbiakban nem jelenik meg a kiválasztott
helyszín listában.

**Mentés**

A **Mentés** gombra kattintva (csak új felvitel és szerkesztés

módban érhető el) csak azon GVK profil azonosítójú felhasználó számára elérhető,

akihez az **OP_H04_01_KodEsHelySzerkeszt** operandus hozzá van rendelve.




-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 26/33|


#92775 eleje Az ablak meghívja az **„S_52 – Kód és hely adatainak mentése”** eljárást,
visszakapott SQL kód alapján jelenít meg pop-up ablakban.

      - A mentés sikeres, ha a státusz kód 200-as.

`o` A képernyőn az alábbi folyamatok futnak le a lenti sorrendben:

`o` #89383 Napi sorszám generálása és mentése. Az eljárás a HUBA
bejegyzés egyedi azonosítójának bemenő paraméterként
átadásából tudja majd eldönteni, hogy szerkesztés vagy új helyszín
felvitel történt. Utóbbi esetben nem lesz egyedi azonosító.

`o` Amennyiben a felhasználó módosításra nyitotta meg a képernyőt, a

kliens az **„S_27 – Felhasználói aktivitás naplózása** ” szolgáltatástól
(WindowOpen eseménykor) visszakapot **„ACTIVITY_ID** ”-val, soron
kívül elindítja a Konkurenskezelés életjelküldés funkcióját, a
**„K_15_02 – Életjel küldés (SET_DATA_LIFESIGN)”** függvény
meghívásával.

`o` Amennyiben a felhasználó módosításra nyitotta meg a képernyőt, a

kliens lezárja a munkamenetet a **„K_15_04 – Munkamenet lezárás**
**(SET_DATA_CLOSE)”** eljárás meghívásával, amihez bemenő
paraméterként az **„S_27 – Felhasználói aktivitás naplózása** ”
szolgáltatástól (WindowOpen eseménykor) visszakapot
**„ACTIVITY_ID** ”-t küldi be.

`o` A mentést követően a kliens meghívja az „ **S_27 – Felhasználói**

**aktivitás** **naplózása** ” szolgáltatást az alábbi bemenő
paraméterekkel:

`o` Ablakazonosító (’WINDOW_ID’): „H04_01”
`o` Esemény (’ACTIVITY’): „Create” vagy „Modify”
`o` AD felhasználó (’AD_USER’): bejelentkezett felhasználó AD

azonosítója
`o` GVK felhasználó (’GVK_USER’): GVK felhasználói profil

azonosítója
`o` Esemény kiegészítő információk (’ACTIVITY_EXT’): JSON

formában a mentés részletei

`o` Bejegyzés azonosító (’MAIN_ID’): HUBA bejegyzés
azonosítója
`o` Bejegyzés sub azonosító (’SUB_ID’): NULL
`o` Előzmény felhasználói aktivitás azonosító
(’PRE_ACTIVITY_ID’): A WindowOpen eseménykor kapott
**ACTIVITY_ID.**


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 27/33|



       - Ha a mentés nem sikeres 599-es vagy 400-as státusz kódot kap a kliens.

Mindkét esetben az alábbi hibaüzenetet kell megjeleníteni, a kapott

RequiestId-val. [#92775] [vége]

**Mégsem**

A **Mégsem** gombra kattintva a kliens ellenőrzi, hogy
történt-e bármilyen adatmódosítás a képernyőn (csak új felvitel és szerkesztés
módban), és ha igen, az alábbi üzenetet küldi:

Ha a felhasználó az **Igen** opciót választja, a képernyő mentés nélkül bezárul, a
**Nem** opció esetén pedig a felhasználó folytathatja a munkát a „ **H04_01** **- HUBA**
**– Kód és hely** ” ablakon.

Amennyiben a képernyő bezárásra kerül, és a felhasználó szerkesztés módban nyitotta meg a
képernyőt, a kliens meghívja a **„K_15_04 – Munkamenet lezárás (SET_DATA_CLOSE)”** eljárást,
amihez bemenő paraméterként az **„S_27 – Felhasználói aktivitás naplózása** ” szolgáltatástól
(WindowOpen eseménykor) visszakapot **„ACTIVITY_ID** ”-t küldi be. Ezzel zárja a

munkamenetet.

**Ablak bezárása** **[[#89250]](https://tadads1.tad.mavinformatika.hu/MAVICollection/IFP/_workitems/edit/89370)**

A képernyő bezárásakor a kliens meghívja az „ **S_27 – Felhasználói aktivitás naplózása** ”
szolgáltatást az alábbi bemenő paraméterekkel:

  - Ablakazonosító (’WINDOW_ID’): „H04_01”

  - Esemény (’ACTIVITY’): WindowClose


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 28/33|



 - AD felhasználó (’AD_USER’): bejelentkezett felhasználó AD azonosítója

 - GVK felhasználó (’GVK_USER’): GVK felhasználói profil azonosítója

 - Esemény kiegészítő információk (’ACTIVITY_EXT’): „Create”, „Modify” vagy „View” a

megnyitás módjától függően

 - Bejegyzés azonosító (’MAIN_ID’): HUBA bejegyzés azonosítója

 - Bejegyzés sub azonosító (’SUB_ID’): NULL

 - Előzmény felhasználói aktivitás azonosító (’PRE_ACTIVITY_ID’): A WindowOpen

eseménykor kapott **ACTIVITY_ID.**


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 29/33|

### **2.2.4. Az ablak szerkezeti leírása ** **Beviteli/megjelenítő mezők, kiválasztó lista (combo box), kapcsoló, rádiógomb **






















|Felirat|Megnevezés|Súgó (Tooltip) szöveg|Kontrol típusa|Hossz|Maszk|Alapértelmezett érték|Törzstábla/kódtábla|
|---|---|---|---|---|---|---|---|
|Fejléc||||||||
||tab|-|tabbar|||Hálózati elem||
|#89383 #93236 HUBA azonosító|HUBA azonosító|-|||||BEJEGYZES.HUBA_AZ ONOSITO|
|#89383 HUBA Betűkód|HUBA Betűkód|-|||For For|m atted: Strikethrough|BEJEGYZES|
|||||||matted: Strikethrough||
|#89370 Késés főkód|Késés főkód|-|Szöveges beviteli mező kiválasztás funkcióval||||BEJEGYZES|
|#89838 HUBA Betűkód – szabad szöveges rész|HUBA Betűkód –|-|Szabad||For|m atted: Strikethrough|BEJEGYZES #89838|
||szabad szöveges rész||szöveges beviteli mező||For|matted: Strikethrough||
|||||||||
|#89371 Topográfiai elem||||||||
|Topográfiai elem kiválasztása forgalmi szakaszról||-|||||BEJEGYZES_HELYSZ IN.FORGALMI_SZA KASZ_ID|
|Topográfiai elem kiválasztása szolgálati helyről||-|||||BEJEGYZES_HELYSZI N.RAILWAY_OBJECT _ID|
|Topográfiai elem típusa||-|||||GVK.K_OBJEKTUM_A LKATEGORIA|
|Topográfiai elem||-|||||BEJEGYZES_HELYSZI N.RAILWAY_OBJECT _ID|
|#89372 Terület||||||||
|Hálózat|Hálózat|-||||MÁV Zrt.||
|Terület|Terület|-|Szöveges beviteli mező kiválasztás funkcióval||||BEJEGYZES_HELYSZ IN.TERULET|
|Forgalmi csomópont|Forgalmi csomópont|-|Szöveges beviteli mező kiválasztás funkcióval||||BEJEGYZES_HELYSZ IN.FORGALMI_CSO MOPONT|

### BEJEGYZES_HELYSZ IN.ALLOMASFONO KSEG




##### Szöveges beviteli mező kiálastás

#### Állomásfőnökség Állomásfőnökség 

-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 30/33|















|Felirat|Megnevezés|Súgó (Tooltip) szöveg|Kontrol típusa|Hossz|Maszk|Alapértelmezett érték|Törzstábla/kódtábla|
|---|---|---|---|---|---|---|---|
|Szolgálati hely (tól- ig) 1|Szolgálati hely (tól-ig) 1|-|Szöveges beviteli mező kiválasztás funkcióval||||BEJEGYZES_HELYSZ IN.SZOLGHELY_TOL|
|Szolgálati hely (tól- ig) 2|Szolgálati hely (tól-ig) 2|-|Szöveges beviteli mező kiválasztás funkcióval||||BEJEGYZES_HELYSZ IN.SZOLGHELY_IG|
|Szelvény (tól-ig) 1|Szelvény (tól-ig) 1|-|Szöveges beviteli mező kiválasztás funkcióval||||BEJEGYZES_HELYSZ IN.SZELVENY_TOL|
|Szelvény (tól-ig) 2|||||||BEJEGYZES_HELYSZ IN.SZELVENY_IG|
|#89375 Jármű/Vonat/Egyéb||||||||
|Vonatazonosító|Vonatazonosító|-|Szöveges beviteli mező|-|-|-|BEJEGYZES_HELYSZIN. VONATAZONOSITO|
|Közlekedési dátum|Közlekedési dátum|-|Dátum beviteli mező|8|ÉÉÉÉ/HH/NN|-|BEJEGYZES_HELYSZIN. VONAT_IND_DATUM|
|Pályaszám|Pályaszám|-|Szöveges beviteli mező formátum ellenőrzéssel|-||-|BEJEGYZES_HELYSZIN.J ARMU_PALYASZAM|
|Főkategória|Főkategória-|-|Szöveges beviteli mező kiválasztás funkcióval||-|-|BEJEGYZES_HELYSZIN. FOKATEGORIA_ID|
|Alkategória|Alkategória|-|Szöveges beviteli mező kiválasztás funkcióval||-|-|BEJEGYZES_HELYSZIN. ALKATEGORIA_ID|
|Munkatárs|Munkatárs|-|Szöveges beviteli mező kiválasztás funkcióval és szabad szöveges beviteli mező||-|-|BEJEGYZES_HELYSZIN. MUNKATARS|
|Leírás|Leírás|-|Szabad szöveges leírás|200|-|-|BEJEGYZES_HELYSZIN. LEIRAS|


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 31/33|


**Nyomógombok**





|Felirat|Megnevezés|Súgó (Tooltip) szöveg|Alapértelmezés [megnyomható/nem nyomható meg]|Material ikon neve|
|---|---|---|---|---|
|Hozzáadás|Hozzáadás||||
|Törlés|Törlés||||
|Mentés|Mentés||||
|Mégsem|Mégsem||megnyomható||


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 32/33|


**2.2.6.** **Hívott szolgáltatások**




|Funkciógomb/link/vezérlőelem esemény|Hívott ablak|Hívott szolgáltatás rövid megnevezése (azonosító)|
|---|---|---|
|Ablakbetöltés||S_27 – Felhasználói aktivitás naplózása|
|Ablakbetöltés (konkurenskezeléssel)||K_15_02 – Életjel küldés (SET_DATA_LIFESIGN)|
|Ablakbetöltés||S_08 - Lekérdezési paraméterek értékkészletének lekérdezése|
|Ablakbetöltés||S_53 – Kód és hely adatainak lekérdezése (getHubaKodEsHely)|
|#95441 Ablakbetöltés||S_74 – Bejelentkezett GVK user terület adatának lekérdése (HUBA.Get_Gvk_User_Terulet)|
|Konkurenskezelés (lejárt munkamenet visszaszerzésekor)||K_15_03 – Életjel küldés ellenőrzés nélkül (SET_DATA_FORCE_LIFESIGN)|
|Mentés (konkurenskezeléssel)||K_15_02 – Életjel küldés (SET_DATA_LIFESIGN)|
|Mentés||S_52 – Kód és hely adatainak mentése (setHubaKodEsHely)|
|Mentés (konkurenskezeléssel)||K_15_04 – Munkamenet lezárás (SET_DATA_CLOSE)|
|Mentés||S_27 – Felhasználói aktivitás naplózása|
|Mégsem (konkurenskezeléssel)||K_15_04 – Munkamenet lezárás (SET_DATA_CLOSE)|
|Ablak bezárása||S_27 – Felhasználói aktivitás naplózása|
|Hozzáadás||S_61 – Hierarchia adatok lekérése (HUBA.Get_Hierarchia_adat)|


**2.2.7.** **Rendszerüzenetek**

Nincs. vagy







|Ellenőrzések leírása (HA)|Rendszerüzenet (AKKOR)|Rendszerüzenet típusa|
|---|---|---|
|Ha a munkamenet megszakadt, de még a lezárási időn belül van.|Aktuális munkamenet lejárt. Kívánja folytatni?|Eldöntendő (I/N)|
|Ha a munkamenet megszakadt, és le is záródott.|Aktuális munkamenete lezárult, nem folytatható. Kattintson az OK-ra a képernyő bezárásához.|Figyelmeztető|
|Ha a munkamanet kezelésekor hiba történt|Hiba történt, aktuális munkamenete nem található. Kattintson az OK-ra a képernyő bezárásához.|Figyelmeztető|
|Figyelmeztető üzenet, a Hozzáadás gomb megnyomásakor, ha a rögzítést végző felhasználó hierarchia adata, és a hozzáadni kívánt helyszín|Jogosultsága alapján nem Önhöz tartozó helyszín! Folytatja?|Eldöntendő (I/N)|


-----

|GVK_UC_H00|Col2|Azonosító: RRT_GVK|
|---|---|---|
|Készítette/módosította: MÁV SZK|Változat: 1.0|Oldal: 33/33|


|hierarchia adata eltér egymástól.|Col2|Col3|
|---|---|---|
|Mégsem gomb megnyomásakor, ha a képernyőn történt módosítás|Biztosan elveti a módosításait?|Eldöntendő (I/N)|
|#92775 Az új rekord mentése sikertelen|A mentés során hiba történt. Kérem próbálja újra később. RequiestId: XXX|Hibaüzenet|


**2.2.8.** **Kódtáblák, választási listák**

Nincs.

**2.2.9.** **Rendszerparaméterek**

Nincs. vagy





Helye: /src/BackEnd/GvkBackend/WebApi/appsettings.json

|Rendszerparaméter neve|Rendszerparaméter jelentése|Default érték|Beállított érték|
|---|---|---|---|
|||||
|||||
|||||


-----

